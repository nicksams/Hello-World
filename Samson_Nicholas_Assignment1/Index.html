<script src = "product_data.js"> </script>
<script>var products_array = "product_data.js"</script>
<script>
  function checkQuantityTextbox(theTextbox) {
      errs = isNonNegInt(theTextbox.value, true);
      if (errs.length == 0) errs = ['You want:'];
      if (theTextbox.value.trim() == '') errs = ['Quantity:'];
      document.getElementById(theTextbox.name + '_label').innerHTML=errs.join(',');
    }

 function isNonNegInt(q, return_errors = false) {
        errors = []; // assume no errors at first
        if(q == '') q =0; // handle blank inputs as if they are 0
        if (Number(q) != q) errors.push('<font color="red">Not a number!</font>'); // Check if string is a number value
        else if (q < 0) errors.push('<font color="red">Negative value!</font>'); // Check if it is non-negative
        else if (parseInt(q) != q) errors.push('<font color="red">Not an integer!</font>'); // Check that it is an integer
        return return_errors ? errors : (errors.length == 0);
    }

function displayPurchase(){
      if(isNonNegInt(quantity_textbox.value)){
      document.body.innerHtml= `Thank you for ordering ${quantity_textbox["quantity_textbox"]} Things!`;
      }
  }
  window.onload = function () {
        let params = (new URL(document.location)).searchParams; // get the query string which has the form data
        // form was submitted so check that quantities are valid then redirect to invoice if ok.
        if (params.has('purchase_submit')) {
            has_errors = false; // assume quantities are valid from the start
            total_qty = 0; // need to check if something was selected so we will look if the total > 0
            for (i = 0; i < products.length; i++) {
                if (params.has(`quantity${i}`)) {
                    a_qty = params.get(`quantity${i}`);
                    // make textboxes sticky in case of invalid data
                    product_selection_form[`quantity${i}`].value = a_qty;
                    total_qty += a_qty; 
                    if(!isNonNegInt(a_qty)) {
                        has_errors = true; // oops, invalid quantity
                        checkQuantityTextbox(product_selection_form[`quantity${i}`]); // show where the error is
                    }
                }
            }
            // Now respond to errors or redirect to invoice if all is ok
            if(has_errors) {
                alert("Please enter only valid quantities!");
            } else if(total_qty == 0) { // no quantity selections, just give a general alert
                alert("Please select some quantities!");
            } else { // all good to go!
                window.location = `./order_display.html${document.location.search}`;
                window.stop;
            }
        }
    }
  </script>
<!DOCTYPE html>
<html>
<title>W3.CSS Template</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Karma", sans-serif}
.w3-bar-block .w3-bar-item {padding:20px}
</style>
<body>
<form name="product_selection_form" action="process_form" method="POST">
<!-- Sidebar (hidden by default) -->
<nav class="w3-sidebar w3-bar-block w3-card w3-top w3-xlarge w3-animate-left" style="display:none;z-index:2;width:40%;min-width:300px" id="mySidebar">
  <a href="javascript:void(0)" onclick="w3_close()"
  class="w3-bar-item w3-button">Close Menu</a>
  <a href="#plants" onclick="w3_close()" class="w3-bar-item w3-button">Plants</a>
  <a href="#about" onclick="w3_close()" class="w3-bar-item w3-button">About</a>
</nav>

<!-- Top menu -->
<div class="w3-top">
  <div class="w3-white w3-xlarge" style="max-width:1200px;margin:auto">
    <div class="w3-button w3-padding-16 w3-left" onclick="w3_open()">‚ò∞</div>
    <div class="w3-right w3-padding-16">‚ùÄ‚ô•‚ùÄ‚ô•‚ùÄ</div>
    <div class="w3-center w3-padding-16">‚úøWelcome!‚úø</div>
  </div>
</div>

<!-- !PAGE CONTENT! -->
<hr id="plants">
<div class="w3-main w3-content w3-padding" style="max-width:1200px;margin-top:100px">


  <!-- First Photo Grid-->
  <script>
  for (i = 0; i < products.length; i++) {
  document.write(`
    <div class = "w3-quarter">
    <img src="${products[i].image}" alt=${products[i].brand} style=width="200" height="200">
    <h3>${products[i].brand}</h3>
    <p>${products[i].desc}</p>
    <h3>$${products[i].price}</h3>
    <label id="quantity${i}_label"}">Quantity:</label>
    <input type="text" placeholder="0" name="quantity${i}" onkeyup="checkQuantityTextbox(this);">
    </div>
 `);
}    
</script>
</div>
</hr>
  <!-- Calculate Button -->
    <div class="w3-main w3-content w3-padding" style="text-align: center; margin-top: 500px;">
    <button type="submit" name="purchase_submit">Calculate Total!</button>
    </div>

  
  <hr id="about">

  <!-- About Section -->
  <div class="w3-container w3-padding-32 w3-center">  
    <h3>Me the Loaf</h3><br>
    <img src="sleepy.JPG" alt="Me" class="w3-image" style="display:block;margin:auto" width="200" height="200">
    <div class="w3-padding-32">
      <h4><b>Bark!</b></h4>
      <h6><i>üåæüåøüçÉ for Everyone!</i></h6>
      <p>Studies show that people who spend time cultivating plants have less stress in their lives. Plants soothe human beings and provide a positive way for people to channel their stress into nurturing. Therapeutic Effects of Gardening.</p>
    </div>
  </div>
  <hr>
  
  <!-- Footer -->
  <footer class="w3-row-padding w3-padding-32">
    <div class="w3-third">
      <h3>FOOTER</h3>
      <p>Praesent tincidunt sed tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue gravida diam non fringilla.</p>
      <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
    </div>
  
    <div class="w3-third">
      <h3>BLOG POSTS</h3>
      <ul class="w3-ul w3-hoverable">
        <li class="w3-padding-16">
          <img src="/w3images/workshop.jpg" class="w3-left w3-margin-right" style="width:50px">
          <span class="w3-large">Lorem</span><br>
          <span>Sed mattis nunc</span>
        </li>
        <li class="w3-padding-16">
          <img src="/w3images/gondol.jpg" class="w3-left w3-margin-right" style="width:50px">
          <span class="w3-large">Ipsum</span><br>
          <span>Praes tinci sed</span>
        </li> 
      </ul>
    </div>

    <div class="w3-third w3-serif">
      <h3>POPULAR TAGS</h3>
      <p>
        <span class="w3-tag w3-black w3-margin-bottom">Travel</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">New York</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Dinner</span>
        <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Salmon</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">France</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Drinks</span>
        <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Ideas</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Flavors</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Cuisine</span>
        <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Chicken</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Dressing</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Fried</span>
        <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Fish</span> <span class="w3-tag w3-dark-grey w3-small w3-margin-bottom">Duck</span>
      </p>
    </div>
  </footer>

<!-- End page content -->
</div>

<script>
// Script to open and close sidebar
function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
}
 
function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
}
</script>
</form>
</body>
</html>
